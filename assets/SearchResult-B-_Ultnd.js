import{f as X,u as Z,g as I,h as ee,P as te,t as se,i as ae,j as D,k as R,l as s,m as le,n as O,p as re,R as P,q as oe,s as ue,v as ie,x as ne,y as ce,z as $,A as T,C as pe,B as ve,D as he,E as me,F as de,G as ye,H as ge,I as U,J as fe,K as q}from"./app-D8Yu_QJL.js";const we=["/","/benchmarks.html","/contribute.html","/faq.html","/components/components_overview.html","/components/connection.html","/components/connection_pool.html","/components/connection_pool_builder.html","/components/cursor.html","/components/exceptions.html","/components/listener.html","/components/results.html","/components/transaction.html","/introduction/components_overview.html","/introduction/introduction.html","/introduction/lets_start.html","/integrations/opentelemetry.html","/integrations/taskiq.html","/usage/usage.html","/usage/row_factories/predefined_row_factories.html","/usage/row_factories/row_factories.html","/usage/types/advanced_type_usage.html","/usage/types/array_types.html","/usage/types/extra_types.html","/usage/types/supported_types.html","/usage/types/types.html","/usage/frameworks/aiohttp.html","/usage/frameworks/blacksheep.html","/usage/frameworks/fastapi.html","/usage/frameworks/frameworks.html","/usage/frameworks/litestar.html","/usage/frameworks/robyn.html","/404.html","/components/","/introduction/","/integrations/","/usage/","/usage/row_factories/","/usage/types/","/usage/frameworks/"],ke="SEARCH_PRO_QUERY_HISTORY",y=U(ke,[]),He=()=>{const{queryHistoryCount:l}=q;return{enabled:l>0,queryHistory:y,addQueryHistory:u=>{y.value=Array.from(new Set([u,...y.value.slice(0,l-1)]))},removeQueryHistory:u=>{y.value=[...y.value.slice(0,u),...y.value.slice(u+1)]}}},L=l=>we[l.id]+("anchor"in l?`#${l.anchor}`:""),_e="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:j}=q,g=U(_e,[]),Re=()=>({enabled:j>0,resultHistory:g,addResultHistory:r=>{{const u={link:L(r),display:r.display};"header"in r&&(u.header=r.header),g.value=[u,...g.value.slice(0,j-1)]}},removeResultHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}),qe=l=>{const r=pe(),u=I(),x=ve(),i=D(0),f=R(()=>i.value>0),v=he([]);return me(()=>{const{search:Q,terminate:h}=de(),w=ye(d=>{const k=d.join(" "),{searchFilter:m=a=>a,splitWord:A,suggestionsFilter:o,...n}=r.value;k?(i.value+=1,Q(d.join(" "),u.value,n).then(a=>m(a,k,u.value,x.value)).then(a=>{i.value-=1,v.value=a}).catch(a=>{console.warn(a),i.value-=1,i.value||(v.value=[])})):v.value=[]},q.searchDelay-q.suggestDelay);O([l,u],([d])=>w(d),{immediate:!0}),ge(()=>{h()})}),{isSearching:f,results:v}};var Qe=X({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:r}){const u=Z(),x=I(),i=ee(te),{addQueryHistory:f,queryHistory:v,removeQueryHistory:Q}=He(),{resultHistory:h,addResultHistory:w,removeResultHistory:d}=Re(),k=se(l,"queries"),{results:m,isSearching:A}=qe(k),o=ae({isQuery:!0,index:0}),n=D(0),a=D(0),E=R(()=>v.value.length>0||h.value.length>0),C=R(()=>m.value.length>0),S=R(()=>m.value[n.value]||null),Y=()=>{const{isQuery:e,index:t}=o;t===0?(o.isQuery=!e,o.index=e?h.value.length-1:v.value.length-1):o.index=t-1},B=()=>{const{isQuery:e,index:t}=o;t===(e?v.value.length-1:h.value.length-1)?(o.isQuery=!e,o.index=0):o.index=t+1},M=()=>{n.value=n.value>0?n.value-1:m.value.length-1,a.value=S.value.contents.length-1},z=()=>{n.value=n.value<m.value.length-1?n.value+1:0,a.value=0},G=()=>{a.value<S.value.contents.length-1?a.value+=1:z()},J=()=>{a.value>0?a.value-=1:M()},b=e=>e.map(t=>fe(t)?t:s(t[0],t[1])),K=e=>{if(e.type==="customField"){const t=ne[e.index]||"$content",[c,_=""]=ce(t)?t[x.value].split("$content"):t.split("$content");return e.display.map(p=>s("div",b([c,...p,_])))}return e.display.map(t=>s("div",b(t)))},H=()=>{n.value=0,a.value=0,r("updateQuery",""),r("close")},V=()=>s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.queryHistory),v.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===t}],onClick:()=>{r("updateQuery",e)}},[s($,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:T,onClick:c=>{c.preventDefault(),c.stopPropagation(),Q(t)}})]))])),N=()=>s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.resultHistory),h.value.map((e,t)=>s(P,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===t}],onClick:()=>{H()}},()=>[s($,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(c=>b(c)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:T,onClick:c=>{c.preventDefault(),c.stopPropagation(),d(t)}})]))]));return le("keydown",e=>{if(l.isFocusing){if(C.value){if(e.key==="ArrowUp")J();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const t=S.value.contents[a.value];f(l.queries.join(" ")),w(t),u.push(L(t)),H()}}else if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")B();else if(e.key==="Enter"){const{index:t}=o;o.isQuery?(r("updateQuery",v.value[t]),e.preventDefault()):(u.push(h.value[t].link),H())}}}),O([n,a],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!C.value:!E.value}],id:"search-pro-results"},l.queries.length?A.value?s(re,{hint:i.value.searching}):C.value?s("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:t},c)=>{const _=n.value===c;return s("li",{class:["search-pro-result-list-item",{active:_}]},[s("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),t.map((p,W)=>{const F=_&&a.value===W;return s(P,{to:L(p),class:["search-pro-result-item",{active:F,"aria-selected":F}],onClick:()=>{f(l.queries.join(" ")),w(p),H()}},()=>[p.type==="text"?null:s(p.type==="title"?oe:p.type==="heading"?ue:ie,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[p.type==="text"&&p.header?s("div",{class:"content-header"},p.header):null,s("div",K(p))])])})])})):i.value.emptyResult:E.value?[V(),N()]:i.value.emptyHistory)}});export{Qe as default};
